<h1> Home </h1>
<p>This is the {{ title }} page</p>

<ul id = "list-template">
</ul>

{{!-- {{#if isAvailable}} --}}
            {{!-- <li><a href {{this.name}}>{{this.name}}</a></li> --}}

    {{!-- {{#each  rooms}} --}}
    {{!-- {{/each}}
{{/if}} --}}

<form action = "/create" method = POST>
<input type = "text" name = "roomName" placeholder="Please enter a room name"/>
<input type = "submit" value = "create room"/>
</form>

<script src = "http://twitter.github.io/typeahead.js/js/handlebar.js"></script>

<script>
    window.addEventListener('load',function(){
        setInterval( async function(){
            fetch("http://localhost:8080/getRoom")
            .then(response => response.json())
            .then(data =>{
                var roomJson = data;
                console.log(roomJson);

                var ul_element = document.getElementById('list-template');
                ul_element.innerHTML = "";

                for(var j = 0; j <roomJson.length; j++){
                    var li = document.createElement('li');
                    var a = document.createElement('a');
                    var linkText = document.createTextNode(roomJson[j].name);
                    a.appendChild(linkText);
                    a.title = roomJson[j].name;
                    a.href = `http://localhost:8080/${roomJson[j].name}`
                    li.append(a);
                    document.getElementById('list-template').appendChild(li);
                }
            }).catch(err => {
                console.log("Error when rendering rooms from home.hbs", err); 
            })
        },5000)
    })
</script>